{% include "/admin/sidebar.html" %}
<head>
    <!-- V·∫´n d√πng JS x·ª≠ l√Ω approve/reject -->


    <link rel="stylesheet" href="{{ url_for('static', filename='css/admin/listRestaurant.css') }}"/>

    <style>
        /* H√†ng c√≥ th·ªÉ click */
        .rs-row { position: relative; }
        .rs-row:hover { box-shadow: 0 8px 24px rgba(0,0,0,.12); }

        /* Anchor ph·ªß to√†n b·ªô h√†ng ƒë·ªÉ ƒëi·ªÅu h∆∞·ªõng ‚Äì KH√îNG c·∫ßn JS */
        .row-link {
          position: absolute;
          inset: 0;              /* top/right/bottom/left: 0 */
          z-index: 1;            /* d∆∞·ªõi c√°c n√∫t action */
          display: block;
          border-radius: 12px;   /* kh·ªõp card row n·∫øu c√≥ */
        }

        /* ƒê·∫£m b·∫£o n√∫t action n·∫±m tr√™n anchor v√† v·∫´n b·∫•m ƒë∆∞·ª£c */
        .rs-col--action,
        .rs-action { position: relative; z-index: 2; }

        /* Con tr·ªè tay ƒë·ªÉ ng∆∞·ªùi d√πng bi·∫øt c√≥ th·ªÉ click */
        .rs-row { cursor: pointer; }
    </style>
</head>

<main class="page">
    <div class="container-fluid mt-4">
        <h2 class="mb-4">Danh s√°ch Nh√† h√†ng</h2>

        <table class="rs-table table table-hover align-middle">
            <thead class="rs-thead">
            <tr class="rs-row-head">
                <th class="rs-col-id">ID</th>
                <th class="rs-col-name">T√™n nh√† h√†ng</th>
                <th class="rs-col-addr">ƒê·ªãa ch·ªâ</th>
                <th class="rs-col-status">Tr·∫°ng th√°i</th>
                <th class="rs-col-rating">ƒê√°nh gi√°</th>
                <th class="rs-col-action">Action</th>
            </tr>
            </thead>

            <tbody class="rs-body">
            {% for r in restaurants %}
            <tr class="rs-row" style="cursor:pointer">
  <!-- Anchor overlay ph·ªß to√†n b·ªô h√†ng (tr·ª´ v√πng Action nh·ªù z-index) -->
  <a class="row-link"
     href="{{ url_for('admin.restaurant_detail', restaurant_id=r.restaurant_id) }}"></a>

  <td class="rs-col rs-col--id">
    <div class="rs-id">#{{ r.restaurant_id }}</div>
  </td>

  <td class="rs-col rs-col--name">
    <div class="rs-card">
      <div class="rs-info">
        <div class="rs-title">{{ r.name }}</div>
        {% if r.owner and r.owner.user %}
        <div class="rs-sub">Owner: {{ r.owner.user.email }}</div>
        {% endif %}
      </div>
    </div>
  </td>

  <td class="rs-col rs-col--addr">{{ r.address or "‚Äî" }}</td>

  <td class="rs-col rs-col--status">
    {% if r.status %}
    <span class="rs-badge rs-badge--{{ 'ok' if r.status.value=='APPROVED'
                         else 'warn' if r.status.value=='PENDING'
                         else 'err' }}">{{ r.status.value }}</span>
    {% endif %}
  </td>

  <td class="rs-col rs-col--rating">
    {{ "{:.1f}".format(r.rating_point) if r.rating_point else "Kh√¥ng" }}üåü
  </td>

  <td class="rs-col rs-col--action">
  {% if r.status and r.status.value == 'PENDING' %}
    <button type="button"
            class="rs-action rs-action--approve"
            title="Approve"
            data-id="{{ r.restaurant_id }}"
            onclick="event.stopPropagation();">‚úÖ</button>

    <button type="button"
            class="rs-action rs-action--reject"
            title="Reject"
            data-id="{{ r.restaurant_id }}"
            onclick="event.stopPropagation();">‚ùå</button>
  {% else %}
    <!-- Kh√¥ng hi·ªÉn th·ªã n√∫t khi kh√¥ng c√≤n Pending (ƒë·ªÉ tr·ªëng cho th·∫≥ng h√†ng) -->
  {% endif %}
</td>
</tr>
            {% else %}
            <tr>
                <td colspan="6" class="text-center text-muted py-4">Kh√¥ng c√≥ nh√† h√†ng n√†o.</td>
            </tr>
            {% endfor %}
            </tbody>

        </table>

       {# lu√¥n c√≥ ch·ªó ƒë·ªÉ toast #}
<div id="toast-stack"></div>

{# n·∫øu c√≥ macro noti_assets th√¨ render th√™m, nh∆∞ng KH√îNG ph·ª• thu·ªôc v√†o n√≥ ƒë·ªÉ load JS #}
{% if noti_assets is defined %}
  {{ noti_assets() }}
{% endif %}

<script src="{{ url_for('static', filename='js/toast.js') }}"></script>
<script src="{{ url_for('static', filename='js/admin/manageRestaurant.js') }}?v=3"></script>
    </div>

</main>

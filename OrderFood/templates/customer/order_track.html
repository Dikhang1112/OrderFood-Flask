<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8">
  <title>Theo dõi đơn #{{ order.order_id }}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
  <style>
    .steps { display:flex; gap:24px; justify-content:space-between; margin:24px 0; }
    .step { flex:1; text-align:center; }
    .step .circle {
      width:36px; height:36px; border-radius:50%;
      margin:0 auto 8px; display:flex; align-items:center; justify-content:center;
      border:2px solid #ced4da; background:#fff; color:#6c757d; font-weight:700;
    }
    .step.active .circle { background:#198754; border-color:#198754; color:#fff; } /* xanh lá */
    .step .label { font-weight:600; color:#212529; }
    .step:not(.active) .label { color:#6c757d; }
    .timeline { position:relative; height:4px; background:#e9ecef; margin:0 12px 28px; }
    .timeline::before {
      content:""; position:absolute; left:0; top:0; bottom:0; width:
      calc( ({{ active_idx|default(-1) }} + 1) / 3 * 100% );
      background:#198754;
    }
  </style>
</head>
<body class="bg-light">
  <div class="container py-4">
    <div class="d-flex align-items-center mb-3">
      <a class="btn btn-outline-secondary me-2" href="{{ url_for('index') }}">← Trang chủ</a>
      <h4 class="m-0">Theo dõi đơn hàng #{{ order.order_id }}</h4>
    </div>

    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for cat, msg in messages %}
          <div class="alert alert-{{ cat }}">{{ msg }}</div>
        {% endfor %}
      {% endif %}
    {% endwith %}

    <div class="card shadow-sm">
      <div class="card-body">
        <div class="timeline"></div>

        <div class="steps">
          <div class="step {{ 'active' if active_idx == 0 }}">
            <div class="circle">1</div>
            <div class="label">Đã thanh toán</div>
          </div>
          <div class="step {{ 'active' if active_idx == 1 }}">
            <div class="circle">2</div>
            <div class="label">Xác nhận đơn</div>
          </div>
          <div class="step {{ 'active' if active_idx == 2 }}">
            <div class="circle">3</div>
            <div class="label">{{ last_label }}</div>
          </div>
        </div>

        <hr>

        <div class="row g-3">
          <div class="col-md-6">
            <h6 class="text-muted mb-1">Thông tin đơn</h6>
            <p class="mb-0">
              Nhà hàng: <strong>{{ order.restaurant.name if order.restaurant else '—' }}</strong><br>
              Tổng tiền: <strong>{{ "{:,.0f}".format(order.total_price or 0) }} đ</strong><br>
              Tạo lúc: <strong>{{ order.created_date }}</strong>
            </p>
          </div>
  
        </div>

        <div class="mt-4 d-flex gap-2">
          <a class="btn btn-primary" href="{{ url_for('customer.customer_home') }}">Tiếp tục đặt món</a>
          <a class="btn btn-outline-secondary" href="{{ url_for('customer.restaurant_detail', restaurant_id=order.restaurant_id) }}">Xem nhà hàng</a>
        </div>
      </div>
    </div>
  </div>
</body>
</html>
